{"version":3,"file":"js/6390.a759a92c.js","mappings":"oLACOA,IAAI,iBAAiBC,MAAM,c,0CAAhCC,EAAAA,EAAAA,IAAmD,MAAnDC,EAAmD,S,wBAOrD,GACEC,KAAM,YACNC,MAAO,CACLC,OAAQ,CACNC,KAAMC,OACNC,UAAU,IAGdC,KAAAA,CAAML,GACJ,MAAMM,GAAiBX,EAAAA,EAAAA,IAAI,MAC3B,IAAIY,EAAgB,KAChBC,EAAiB,KAErB,MAAMC,EAAYA,KACXH,EAAeI,QAGhBH,IACFA,EAAcI,UACdJ,EAAgB,MAIlBA,EAAgBK,EAAAA,GAAaN,EAAeI,OAExCV,EAAMC,QAAUE,OAAOU,KAAKb,EAAMC,QAAQa,OAAS,GACrDP,EAAcQ,UAAUf,EAAMC,QAIhCe,OAAOC,iBAAiB,SAAUC,GAGlCV,EAAiB,IAAIW,gBAAe,KAC9BZ,GACFA,EAAca,QAChB,IAEFZ,EAAea,QAAQf,EAAeI,OAAM,EAGxCQ,EAAcA,KACdX,GACFA,EAAca,QAChB,EAmCF,OAhCAE,EAAAA,EAAAA,KAAUC,gBACFC,EAAAA,EAAAA,MACNf,GAAW,KAGbgB,EAAAA,EAAAA,KACE,IAAMzB,EAAMC,SACXyB,IACKnB,GAAiBmB,GAAavB,OAAOU,KAAKa,GAAWZ,OAAS,GAKhEP,EAAcQ,UAAUW,GAAW,EACrC,GAEF,CAAEC,MAAM,KAGVC,EAAAA,EAAAA,KAAgB,KACdZ,OAAOa,oBAAoB,SAAUX,GACjCV,GAAkBF,EAAeI,QACnCF,EAAesB,UAAUxB,EAAeI,OACxCF,EAAeuB,aACfvB,EAAiB,MAEfD,IACFA,EAAcI,UACdJ,EAAgB,KAClB,IAGK,CACLD,iBAEJ,G,UCnFF,MAAM0B,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://tangdata/./src/components/common/ChartView.vue","webpack://tangdata/./src/components/common/ChartView.vue?7c38"],"sourcesContent":["<template>\n  <div ref=\"chartContainer\" class=\"chart-view\"></div>\n</template>\n\n<script>\nimport { ref, onMounted, onBeforeUnmount, watch, nextTick } from 'vue';\nimport * as echarts from 'echarts';\n\nexport default {\n  name: 'ChartView',\n  props: {\n    option: {\n      type: Object,\n      required: true\n    }\n  },\n  setup(props) {\n    const chartContainer = ref(null);\n    let chartInstance = null;\n    let resizeObserver = null;\n\n    const initChart = () => {\n      if (!chartContainer.value) return;\n\n      // 如果已有实例，先销毁\n      if (chartInstance) {\n        chartInstance.dispose();\n        chartInstance = null;\n      }\n\n      // 初始化echarts实例\n      chartInstance = echarts.init(chartContainer.value);\n\n      if (props.option && Object.keys(props.option).length > 0) {\n        chartInstance.setOption(props.option);\n      }\n\n      // 监听窗口resize，自动调整图表大小\n      window.addEventListener('resize', resizeChart);\n\n      // 使用ResizeObserver监听容器尺寸变化\n      resizeObserver = new ResizeObserver(() => {\n        if (chartInstance) {\n          chartInstance.resize();\n        }\n      });\n      resizeObserver.observe(chartContainer.value);\n    };\n\n    const resizeChart = () => {\n      if (chartInstance) {\n        chartInstance.resize();\n      }\n    };\n\n    onMounted(async () => {\n      await nextTick();\n      initChart();\n    });\n\n    watch(\n      () => props.option,\n      (newOption) => {\n        if (chartInstance && newOption && Object.keys(newOption).length > 0) {\n          /** \n           * 当初你需要 true 的可能原因：\tgetCommonChartOption 之前只更新了 series 或部分坐标轴，其他没覆盖 → ECharts 会合并旧配置，导致残影现在是全量生成，所以 false 就够了\n           * 现在改为flase，避免取消某个lengend后，滑动年份，又会重新选中所有的lengend，而且也没出现切换tab和类型后图表显示异常\n           * */ \n          chartInstance.setOption(newOption, false); \n        }\n      },\n      { deep: true }\n    );\n\n    onBeforeUnmount(() => {\n      window.removeEventListener('resize', resizeChart);\n      if (resizeObserver && chartContainer.value) {\n        resizeObserver.unobserve(chartContainer.value);\n        resizeObserver.disconnect();\n        resizeObserver = null;\n      }\n      if (chartInstance) {\n        chartInstance.dispose();\n        chartInstance = null;\n      }\n    });\n\n    return {\n      chartContainer\n    };\n  }\n};\n</script>\n\n<style scoped>\n.chart-view {\n  width: 100%;\n  height: 100%; /* 继承外层容器高度 */\n}\n</style>","import { render } from \"./ChartView.vue?vue&type=template&id=0a1bff51&scoped=true\"\nimport script from \"./ChartView.vue?vue&type=script&lang=js\"\nexport * from \"./ChartView.vue?vue&type=script&lang=js\"\n\nimport \"./ChartView.vue?vue&type=style&index=0&id=0a1bff51&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0a1bff51\"]])\n\nexport default __exports__"],"names":["ref","class","_createElementBlock","_hoisted_1","name","props","option","type","Object","required","setup","chartContainer","chartInstance","resizeObserver","initChart","value","dispose","echarts","keys","length","setOption","window","addEventListener","resizeChart","ResizeObserver","resize","observe","onMounted","async","nextTick","watch","newOption","deep","onBeforeUnmount","removeEventListener","unobserve","disconnect","__exports__","render"],"sourceRoot":""}