"use strict";(self["webpackChunktangdata"]=self["webpackChunktangdata"]||[]).push([[3241],{3241:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var r=a(6768);function n(e,t,a,n,o,l){const s=(0,r.g2)("ChartPage");return o.returnData?((0,r.uX)(),(0,r.Wv)(s,{key:0,chartMetaList:o.charts,returnData:o.returnData,config:o.config,showToggles:!0},null,8,["chartMetaList","returnData","config"])):(0,r.Q3)("",!0)}var o=a(933),l=a(6280),s=a(6311),c=a(373),i={name:"ForeignTrade",components:{ChartPage:o.A},data(){return{charts:l.yx.charts,returnData:null,config:l.yx.source}},async mounted(){try{this.returnData=await(0,s.hv)(this.config)}catch(e){c.v.error("加载数据失败",e)}}},d=a(1241);const u=(0,d.A)(i,[["render",n]]);var h=u},933:function(e,t,a){a.d(t,{A:function(){return _}});var r=a(6768),n=a(4232);const o={class:"echart-container"},l={key:0,class:"segment-container"},s={class:"segment-wrapper"};function c(e,t,a,c,i,d){const u=(0,r.g2)("ChartContainer");return(0,r.uX)(),(0,r.CE)("div",o,[d.internalShowToggles?((0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",s,[(0,r.Lk)("div",{class:(0,n.C4)(["segment-bg",i.viewMode])},null,2),(0,r.Lk)("button",{class:(0,n.C4)(["segment-button",{active:"monthly"===i.viewMode}]),onClick:t[0]||(t[0]=e=>i.viewMode="monthly")},"月度",2),(0,r.Lk)("button",{class:(0,n.C4)(["segment-button",{active:"yearly"===i.viewMode}]),onClick:t[1]||(t[1]=e=>i.viewMode="yearly")},"年度",2)])])):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(d.chartsToRender,(e=>((0,r.uX)(),(0,r.Wv)(u,{key:e.id,chart:e,returnData:a.returnData,config:a.config,viewMode:i.viewMode},null,8,["chart","returnData","config","viewMode"])))),128))])}const i=e=>((0,r.Qi)("data-v-4e2d40b0"),e=e(),(0,r.jt)(),e),d={class:"chart-container"},u={class:"chart-title"},h={key:0,class:"chart-subtitle"},p={class:"controls-wrap"},g={class:"chart-controls"},v={class:"time-legend-row"},y=i((()=>(0,r.Lk)("label",{class:"year-label"},"滑动时间",-1))),b={class:"chart-card"};function C(e,t,a,o,l,s){const c=(0,r.g2)("el-slider"),i=(0,r.g2)("ChartView");return(0,r.uX)(),(0,r.CE)("div",d,[(0,r.Lk)("h3",u,(0,n.v_)(a.chart.title),1),a.chart.subtitle?((0,r.uX)(),(0,r.CE)("h4",h,(0,n.v_)(a.chart.subtitle),1)):(0,r.Q3)("",!0),(0,r.Lk)("div",p,[(0,r.Lk)("div",g,[(0,r.Lk)("button",{class:(0,n.C4)(["chart-button",{"is-active":"bar"===o.chartType&&!o.isHorizontal}]),onClick:t[0]||(t[0]=e=>o.setChartType("bar",!1))},"柱状图",2),(0,r.Lk)("button",{class:(0,n.C4)(["chart-button",{"is-active":"bar"===o.chartType&&o.isHorizontal}]),onClick:t[1]||(t[1]=e=>o.setChartType("bar",!0))},"条形图",2),(0,r.Lk)("button",{class:(0,n.C4)(["chart-button",{"is-active":"line"===o.chartType&&!o.isHorizontal}]),onClick:t[2]||(t[2]=e=>o.setChartType("line",!1))},"折线图",2)]),(0,r.Lk)("div",v,[y,(0,r.bF)(c,{modelValue:o.yearLimit,"onUpdate:modelValue":t[3]||(t[3]=e=>o.yearLimit=e),min:1,max:20,step:1,"show-tooltip":"","format-tooltip":o.formatTooltip,class:"year-slider"},null,8,["modelValue","format-tooltip"]),(0,r.Lk)("button",{class:"toggle-legend-btn",style:(0,n.Tr)({backgroundColor:o.legendAllSelected?"#0bc2d6":"#ccc"}),onClick:t[4]||(t[4]=(...e)=>o.toggleAllLegends&&o.toggleAllLegends(...e))},(0,n.v_)(o.legendAllSelected?"一键未选":"一键全选"),5)])]),(0,r.Lk)("div",b,[(0,r.bF)(i,{option:o.chartOption,class:"chart-wrapper",onLegendselectchanged:o.handleLegendSelect},null,8,["option","onLegendselectchanged"])])])}var f=a(144);const m={ref:"chartContainer",class:"chart-view"};function w(e,t,a,n,o,l){return(0,r.uX)(),(0,r.CE)("div",m,null,512)}var L=a(1557),k={props:["option"],setup(e){const t=(0,f.KR)(null);let a=null;const n=()=>{if(t.value){a&&a.dispose();try{a=L.Ts(t.value);const r={xAxis:{type:"category",data:["A","B","C"]},yAxis:{type:"value"},series:[{data:[1,2,3],type:"line"}]};a.setOption(r),e.option&&a.setOption(e.option),a.resize(),setTimeout((()=>{}),100)}catch(r){}}};return(0,r.sV)((()=>{n()})),(0,r.wB)((()=>e.option),(e=>{a&&e&&a.setOption(e)}),{deep:!0}),(0,r.xo)((()=>{a?.dispose()})),{chartContainer:t}}},T=a(1241);const A=(0,T.A)(k,[["render",w],["__scopeId","data-v-4f5c540a"]]);var M=A,D=a(5e3),O={name:"ChartContainer",components:{ChartView:M},props:{chart:{type:Object,required:!0},returnData:{type:Object,required:!0},config:{type:Object,default:()=>({})},viewMode:{type:String,default:"monthly"}},setup(e){const t=(0,f.KR)("bar"),a=(0,f.KR)(!1),n=(0,f.KR)(10),o=(0,f.KR)({}),l=(0,f.KR)(!0),s=(0,r.EW)((()=>{const r={data:e.returnData,cityCodeArr:e.config?.cityCodeArr||[],title:e.chart.title,subtitle:e.chart.subtitle,dbCode:e.chart.dbCode,zbcodeArr:e.chart.zbcodeArr,unit:e.chart.unit,exceptName:e.chart.exceptName,legendTop:c(),gridTop:e.chart.gridTop,echrtId:e.chart.id,chartType:t.value,yearLimit:n.value,isHorizontal:a.value,legendStates:o.value,legendAllSelected:l.value},s=(0,D.HM)(r);return s.title&&delete s.title,s})),c=()=>{const t=e.chart.legendTop||"15%";if(window.innerWidth<=768){if("string"===typeof t&&t.endsWith("%")){const e=parseFloat(t);return e/3+"%"}return"number"===typeof t?t/3:"5%"}return t},i=(e,r)=>{t.value=e,a.value=r},d=e=>{e?.name&&(o.value={...o.value,[e.name]:e.selected[e.name]},u())},u=()=>{const e=Object.values(o.value);l.value=e.length>0&&e.every((e=>e))},h=()=>{const e=!l.value,t={};Object.keys(o.value).forEach((a=>{t[a]=e})),o.value=t,l.value=e};(0,r.wB)(n,(()=>{const e={};Object.keys(o.value).forEach((t=>{e[t]=!0})),o.value=e,l.value=!0}));const p=t=>{const a="monthly"===e.viewMode?"个月":"年";return`近 ${t} ${a}`};return{chartType:t,isHorizontal:a,yearLimit:n,legendAllSelected:l,chartOption:s,setChartType:i,handleLegendSelect:d,toggleAllLegends:h,formatTooltip:p}}};const S=(0,T.A)(O,[["render",C],["__scopeId","data-v-4e2d40b0"]]);var j=S,x={components:{ChartContainer:j},props:{chartMetaList:Array,returnData:Object,config:Object,showToggles:{type:Boolean,default:!0}},data(){return{viewMode:"monthly"}},computed:{internalShowToggles(){if(!this.showToggles)return!1;const e=new Set(this.chartMetaList.map((e=>e.dbCode)));return e.has("yd")&&e.has("nd")},defaultViewMode(){const e=new Set(this.chartMetaList.map((e=>e.dbCode)));return e.has("yd")?"monthly":e.has("nd")?"yearly":"monthly"},filteredCharts(){return this.internalShowToggles?this.chartMetaList.filter((e=>"monthly"===this.viewMode?"yd"===e.dbCode:"nd"===e.dbCode)):this.chartMetaList},chartsToRender(){return this.filteredCharts.filter((e=>{const t=this.returnData?.dataList?.sj?.[e.dbCode];return Array.isArray(t)&&t.length>0}))}},created(){this.viewMode=this.defaultViewMode}};const E=(0,T.A)(x,[["render",c],["__scopeId","data-v-ce7a7c4e"]]);var _=E}}]);
//# sourceMappingURL=3241.40c88d08.js.map