"use strict";(self["webpackChunktangdata"]=self["webpackChunktangdata"]||[]).push([[69,2202,88],{2202:function(t,e,r){r.r(e),r.d(e,{default:function(){return u}});var n=r(6768);const a={class:"chart-card"};function o(t,e,r,o,i,c){const l=(0,n.g2)("ChartView");return(0,n.uX)(),(0,n.CE)("div",a,[(0,n.bF)(l,{option:c.chartOption,class:"chart-wrapper"},null,8,["option"])])}var i=r(88),c=r(5e3),l={components:{ChartView:i["default"]},props:{chart:Object,returnData:Object,config:Object,chartType:String,yearLimit:{type:Number,default:10},isHorizontal:Boolean,legendAllSelected:Boolean},computed:{adjustedLegendTop(){const t=this.chart.legendTop||"15%";if(window.innerWidth<=768){if("string"===typeof t&&t.endsWith("%")){const e=parseFloat(t);return e/3+"%"}return"number"===typeof t?t/3:"5%"}return t},chartOption(){const t={data:this.returnData,cityCodeArr:this.config?.cityCodeArr||[],title:this.chart.title,subtitle:this.chart.subtitle,dbCode:this.chart.dbCode,zbcodeArr:this.chart.zbcodeArr,unit:this.chart.unit,exceptName:this.chart.exceptName,legendTop:this.adjustedLegendTop,gridTop:this.chart.gridTop,echrtId:this.chart.id,chartType:this.chartType,yearLimit:this.yearLimit,isHorizontal:this.isHorizontal,legendAllSelected:this.legendAllSelected},e=(0,c.HM)(t);return e.title&&delete e.title,e}}},s=r(1241);const d=(0,s.A)(l,[["render",o],["__scopeId","data-v-16ae2ee1"]]);var u=d},69:function(t,e,r){r.r(e),r.d(e,{default:function(){return C}});var n=r(6768),a=r(4232);const o=t=>((0,n.Qi)("data-v-719eb7c0"),t=t(),(0,n.jt)(),t),i={class:"chart-container"},c={class:"chart-title"},l={key:0,class:"chart-subtitle"},s={class:"controls-wrap"},d={class:"chart-controls"},u={class:"time-legend-row"},h={class:"year-selector"},p=o((()=>(0,n.Lk)("label",{class:"year-label"},"选择时间范围",-1)));function b(t,e,r,o,b,g){const y=(0,n.g2)("el-slider"),v=(0,n.g2)("ChartCard");return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("h3",c,(0,a.v_)(r.chart.title),1),r.chart.subtitle?((0,n.uX)(),(0,n.CE)("h4",l,(0,a.v_)(r.chart.subtitle),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",s,[(0,n.Lk)("div",d,[(0,n.Lk)("button",{class:(0,a.C4)(["chart-button",{"is-active":"bar"===o.chartType&&!o.isHorizontal}]),onClick:e[0]||(e[0]=t=>{o.chartType="bar",o.isHorizontal=!1})},"柱状图",2),(0,n.Lk)("button",{class:(0,a.C4)(["chart-button",{"is-active":"bar"===o.chartType&&o.isHorizontal}]),onClick:e[1]||(e[1]=t=>{o.chartType="bar",o.isHorizontal=!0})},"条形图",2),(0,n.Lk)("button",{class:(0,a.C4)(["chart-button",{"is-active":"line"===o.chartType&&!o.isHorizontal}]),onClick:e[2]||(e[2]=t=>{o.chartType="line",o.isHorizontal=!1})},"折线图",2)]),(0,n.Lk)("div",u,[(0,n.Lk)("div",h,[p,(0,n.bF)(y,{modelValue:o.yearLimit,"onUpdate:modelValue":e[3]||(e[3]=t=>o.yearLimit=t),min:1,max:20,step:1,"show-tooltip":"","format-tooltip":o.formatTooltip,class:"year-slider"},null,8,["modelValue","format-tooltip"])]),(0,n.Lk)("button",{class:"toggle-legend-btn",style:(0,a.Tr)({backgroundColor:o.legendAllSelected?"#0bc2d6":"#ccc"}),onClick:e[4]||(e[4]=(...t)=>o.toggleLegend&&o.toggleLegend(...t))},(0,a.v_)(o.legendAllSelected?"一键未选":"一键全选"),5)])]),(0,n.bF)(v,{chart:r.chart,chartType:o.chartType,returnData:r.returnData,config:r.config,yearLimit:o.yearLimit,isHorizontal:o.isHorizontal,legendAllSelected:o.legendAllSelected},null,8,["chart","chartType","returnData","config","yearLimit","isHorizontal","legendAllSelected"])])}var g=r(144),y=r(2202),v={components:{ChartCard:y["default"]},props:{chart:Object,returnData:Object,config:Object,initialChartType:{type:String,default:"bar"},viewMode:String},setup(t){const e=(0,g.KR)(t.initialChartType),r=(0,g.KR)(!1),n=(0,g.KR)(10),a=(0,g.KR)(!0),o=()=>{a.value=!a.value},i=e=>{const r="monthly"===t.viewMode?"个月":"年";return`近 ${e} ${r}`};return{chartType:e,isHorizontal:r,yearLimit:n,legendAllSelected:a,toggleLegend:o,formatTooltip:i}}},f=r(1241);const m=(0,f.A)(v,[["render",b],["__scopeId","data-v-719eb7c0"]]);var C=m},88:function(t,e,r){r.r(e),r.d(e,{default:function(){return u}});var n=r(6768);const a={ref:"chartContainer",class:"chart-view"};function o(t,e,r,o,i,c){return(0,n.uX)(),(0,n.CE)("div",a,null,512)}var i=r(144),c=r(9671),l={name:"ChartView",props:{option:{type:Object,required:!0},debug:{type:Boolean,default:!1}},setup(t){const e=(0,i.KR)(null);let r=null,a=null,o=0,l=0,s=0;const d=(...e)=>{t.debug&&console.log("[ChartView]",...e)},u=()=>{e.value&&(r||(o++,console.time(`echarts-init-${o}`),r=c.Ts(e.value),console.timeEnd(`echarts-init-${o}`),d(`init #${o} (container):`,e.value),window.addEventListener("resize",p),a=new ResizeObserver((()=>{r&&r.resize()})),a.observe(e.value)),t.option&&Object.keys(t.option).length>0&&h(t.option))},h=t=>{if(!r)return;s++;const e=`echarts-setOption-${s}`;console.time(e);try{r.setOption(t,!1,!0)}catch(n){console.error("[ChartView] setOption error",n)}console.timeEnd(e),d(`setOption count=${s}`)},p=()=>{r&&r.resize()};return(0,n.sV)((async()=>{await(0,n.dY)(),d("onMounted"),u()})),(0,n.wB)((()=>t.option),(t=>{if(t&&Object.keys(t).length>0){const e=performance.now();h(t);const r=performance.now();d(`watch->applyOption elapsed ${(r-e).toFixed(1)} ms`)}}),{deep:!0}),(0,n.xo)((()=>{if(l++,console.time(`echarts-dispose-${l}`),window.removeEventListener("resize",p),a&&e.value){try{a.unobserve(e.value),a.disconnect()}catch(t){}a=null}if(r){try{r.dispose()}catch(t){}r=null}console.timeEnd(`echarts-dispose-${l}`),d("onBeforeUnmount, disposeCount=",l)})),{chartContainer:e}}},s=r(1241);const d=(0,s.A)(l,[["render",o],["__scopeId","data-v-4a7cde61"]]);var u=d}}]);
//# sourceMappingURL=69.a0f225f8.js.map