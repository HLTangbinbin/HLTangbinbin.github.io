{"version":3,"file":"js/9892.a871679b.js","mappings":"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","sources":["webpack://tangdata/./src/components/common/ChartCard.vue","webpack://tangdata/./src/components/common/ChartCard.vue?7a80","webpack://tangdata/./src/components/common/ChartContainer.vue","webpack://tangdata/./src/components/common/ChartContainer.vue?9df1","webpack://tangdata/./src/components/common/ChartPage.vue","webpack://tangdata/./src/components/common/ChartPage.vue?6ceb","webpack://tangdata/./src/components/common/ChartView.vue","webpack://tangdata/./src/components/common/ChartView.vue?7c38"],"sourcesContent":["<template>\n  <div class=\"chart-card\">\n    <ChartView :option=\"chartOption\" class=\"chart-wrapper\" />\n  </div>\n</template>\n\n<script>\nimport ChartView from './ChartView.vue';\nimport { getCommonChartOption } from '@/utils/CommonUtil.js';\n\nexport default {\n  components: { ChartView },\n  props: {\n    chart: Object,\n    returnData: Object,\n    config: Object,\n    chartType: String, // 'bar' 或 'line'\n    yearLimit: {\n      type: Number,\n      default: 10\n    },\n    isHorizontal: Boolean,\n  },\n  computed: {\n    adjustedLegendTop() {\n      const baseTop = this.chart.legendTop || '15%';\n\n      // 处理字符串百分比\n      if (window.innerWidth <= 768) { // 移动端\n        if (typeof baseTop === 'string' && baseTop.endsWith('%')) {\n          const num = parseFloat(baseTop);\n          return (num / 3) + '%'; // 缩小为原来的三分之一\n        }\n        if (typeof baseTop === 'number') {\n          return baseTop / 3; // 数值缩小\n        }\n        return '5%'; // 默认值\n      }\n      // PC端正常返回\n      return baseTop;\n    },\n\n    chartOption() {\n      const params = {\n        // 只取必要字段，避免污染\n        data: this.returnData,\n        cityCodeArr: this.config?.cityCodeArr || [],\n        // 图表相关\n        title: this.chart.title,\n        subtitle: this.chart.subtitle,\n        dbCode: this.chart.dbCode,\n        zbcodeArr: this.chart.zbcodeArr,\n        unit: this.chart.unit,\n        exceptName: this.chart.exceptName,\n        legendTop: this.adjustedLegendTop,\n        gridTop: this.chart.gridTop,\n        echrtId: this.chart.id,\n        chartType: this.chartType,\n        yearLimit: this.yearLimit,\n        isHorizontal: this.isHorizontal,\n        \n      };\n      const option = getCommonChartOption(params);\n\n      if (option.title) delete option.title; // 防止重复标题显示\n\n      return option;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.chart-card {\n  width: 95%;\n  height: 600px;\n  margin: 0 auto;\n}\n\n.chart-wrapper {\n  width: 100%;\n  height: 100%;\n}\n</style>","import { render } from \"./ChartCard.vue?vue&type=template&id=634bd65e&scoped=true\"\nimport script from \"./ChartCard.vue?vue&type=script&lang=js\"\nexport * from \"./ChartCard.vue?vue&type=script&lang=js\"\n\nimport \"./ChartCard.vue?vue&type=style&index=0&id=634bd65e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-634bd65e\"]])\n\nexport default __exports__","<template>\n  <div class=\"chart-container\">\n    <h3 class=\"chart-title\">{{ chart.title }}</h3>\n    <h4 v-if=\"chart.subtitle\" class=\"chart-subtitle\">{{ chart.subtitle }}</h4>\n\n    <div class=\"chart-controls\">\n      <button\n        :class=\"[\n          'chart-button',\n          { 'is-active': chartType === 'bar' && isHorizontal === false },\n        ]\"\n        @click=\"chartType = 'bar'; isHorizontal = false\"\n        type=\"button\"\n      >\n        柱状图\n      </button>\n      <button\n        :class=\"[\n          'chart-button',\n          { 'is-active': chartType === 'bar' && isHorizontal === true },\n        ]\"\n        @click=\"chartType = 'bar'; isHorizontal = true\"\n        type=\"button\"\n      >\n        条形图\n      </button>\n      <button\n        :class=\"['chart-button', { 'is-active': chartType === 'line' && isHorizontal === false }]\"\n        @click=\"chartType = 'line'; isHorizontal = false\"\n        type=\"button\"\n      >\n        折线图\n      </button>\n    </div>\n    <div class=\"year-selector\">\n      <label class=\"year-label\">选择时间范围</label>\n      <el-slider\n        v-model=\"yearLimit\"\n        :min=\"1\"\n        :max=\"20\"\n        :step=\"1\"\n        show-tooltip\n        :format-tooltip=\"formatTooltip\"\n        class=\"year-slider\"\n      />\n    </div>\n\n    <ChartCard\n      :chart=\"chart\"\n      :chartType=\"chartType\"\n      :returnData=\"returnData\"\n      :config=\"config\"\n      :yearLimit=\"yearLimit\"\n      :isHorizontal=\"isHorizontal\"\n    />\n  </div>\n</template>\n\n<script>\nimport ChartCard from \"./ChartCard.vue\";\n\nexport default {\n  components: { ChartCard },\n  props: {\n    chart: Object,\n    returnData: Object,\n    config: Object,\n    initialChartType: {\n      type: String,\n      default: \"bar\",\n    },\n    viewMode: String,\n  },\n  data() {\n    return {\n      chartType: this.initialChartType,\n      yearLimit: 10,\n      isHorizontal: false\n    };\n  },\n  computed: {\n    // 支持动态 tooltip 格式\n    formatTooltip() {\n      return (val) => {\n        const unit = this.viewMode === \"monthly\" ? \"个月\" : \"年\";\n        return `近 ${val} ${unit}`;\n      };\n    },\n  },\n};\n</script>\n\n\n\n<style scoped>\n.chart-container {\n  width: 100%;\n  max-width: 1500px;\n  margin: 0 auto 60px;\n  padding: 16px;\n  box-sizing: border-box;\n  background-color: #fff;\n  border-radius: 12px;\n  box-shadow: 0 0 8px rgba(0, 0, 0, 0.06);\n  margin-top: 50px;\n}\n\n.chart-title {\n  text-align: center;\n  font-size: 18px;\n  font-weight: 700;\n  /* 比 500 更粗，接近 canvas 渲染视觉效果 */\n  color: #333;\n  font-family: \"Microsoft YaHei\", \"Helvetica Neue\", Arial, sans-serif;\n  margin: 24px 0 6px;\n  line-height: 1.4;\n}\n\n.chart-subtitle {\n  font-size: 13px;\n  font-weight: bold;\n  line-height: 20px;\n  color: #666;\n  /* 可改为 #aaa 如果需要更淡 */\n  text-align: center;\n  white-space: pre-line;\n  overflow-wrap: break-word;\n  margin: 0 auto 12px;\n  max-width: 80vw;\n  /* 等价于 window.innerWidth * 0.8 */\n}\n\n.chart-controls {\n  display: flex;\n  justify-content: center;\n  gap: 12px;\n  margin-bottom: 16px;\n  margin-top: 8px;\n  /* ✅ 确保和 legend 保持间隔 */\n}\n\n.chart-button {\n  padding: 6px 12px;\n  font-size: 13px;\n  border-radius: 10px;\n  background-color: #ccc;\n  color: #fff;\n  border: none;\n  cursor: pointer;\n  transition: background 0.3s;\n  margin-top: 10px;\n}\n\n.chart-button.is-active {\n  background-color: #0bc2d6;\n}\n\n.year-selector {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  /* 横向居中 */\n  justify-content: center;\n  /* 纵向居中 */\n  margin: 16px 0;\n}\n\n.year-label {\n  padding: 6px 8px;\n  font-size: 13px;\n  border-radius: 8px;\n  font-weight: bold;\n  margin-bottom: 8px;\n  color: #fff;\n  background-color: #0bc2d6 !important;\n}\n\n/* 限制滑块宽度 */\n.year-slider {\n  width: 10%; /* 默认 PC 端 */\n  min-width: 100px; /* 避免过窄 */\n}\n\n/* Vue3 推荐写法：v-deep 前缀，作用于 element-plus 内部 */\n::v-deep(.year-slider .el-slider__bar) {\n  background-color: #0bc2d6 !important;\n}\n\n::v-deep(.year-slider .el-slider__button) {\n  background-color: #0bc2d6 !important;\n  border-color: #0bc2d6 !important;\n}\n</style>","import { render } from \"./ChartContainer.vue?vue&type=template&id=10d8bf4a&scoped=true\"\nimport script from \"./ChartContainer.vue?vue&type=script&lang=js\"\nexport * from \"./ChartContainer.vue?vue&type=script&lang=js\"\n\nimport \"./ChartContainer.vue?vue&type=style&index=0&id=10d8bf4a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-10d8bf4a\"]])\n\nexport default __exports__","<template>\n  <div class=\"echart-container\">\n    <div v-if=\"internalShowToggles\" class=\"segment-container\">\n      <div class=\"segment-wrapper\">\n        <div class=\"segment-bg\" :class=\"viewMode\"></div>\n        <button class=\"segment-button\" :class=\"{ active: viewMode === 'monthly' }\"\n          @click=\"viewMode = 'monthly'\">月度</button>\n        <button class=\"segment-button\" :class=\"{ active: viewMode === 'yearly' }\"\n          @click=\"viewMode = 'yearly'\">年度</button>\n      </div>\n    </div>\n\n    <ChartContainer v-for=\"chart in chartsToRender\" :key=\"chart.id\" :chart=\"chart\" :returnData=\"returnData\"\n      :config=\"config\" :viewMode=\"viewMode\" />\n  </div>\n</template>\n\n<script>\nimport ChartContainer from './ChartContainer.vue';\n\nexport default {\n  components: { ChartContainer },\n  props: {\n    chartMetaList: Array,\n    returnData: Object,\n    config: Object,\n    showToggles: { type: Boolean, default: true },\n  },\n  data() {\n    return {\n      viewMode: 'monthly',\n    };\n  },\n  computed: {\n    internalShowToggles() {\n      if (!this.showToggles) return false;\n      const dbCodes = new Set(this.chartMetaList.map((c) => c.dbCode));\n      return dbCodes.has('yd') && dbCodes.has('nd');\n    },\n    defaultViewMode() {\n      const dbCodes = new Set(this.chartMetaList.map((c) => c.dbCode));\n      if (dbCodes.has('yd')) return 'monthly';\n      if (dbCodes.has('nd')) return 'yearly';\n      return 'monthly';\n    },\n    filteredCharts() {\n      if (!this.internalShowToggles) return this.chartMetaList;\n      return this.chartMetaList.filter((c) =>\n        this.viewMode === 'monthly' ? c.dbCode === 'yd' : c.dbCode === 'nd'\n      );\n    },\n    chartsToRender() {\n      return this.filteredCharts.filter((chart) => {\n        const sj = this.returnData?.dataList?.sj?.[chart.dbCode];\n        return Array.isArray(sj) && sj.length > 0;\n      });\n    },\n  },\n  created() {\n    this.viewMode = this.defaultViewMode;\n  },\n};\n</script>\n\n<style scoped>\n.segment-container {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  margin-top: 10px;\n  margin-bottom: 30px;\n}\n\n.segment-wrapper {\n  position: relative;\n  display: flex;\n  width: 200px;\n  height: 45px;\n  background-color: #fff;\n  border-radius: 999px;\n  padding: 2px;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n  /* ✅ 外部阴影更明显 */\n}\n\n/* 背景高亮滑块 */\n.segment-bg {\n  position: absolute;\n  top: 2px;\n  bottom: 2px;\n  width: 50%;\n  border-radius: 999px;\n  background-color: #0bc2d6;\n  transition: left 0.25s ease;\n  z-index: 0;\n}\n\n.segment-bg.monthly {\n  left: 2px;\n}\n\n.segment-bg.yearly {\n  left: 50%;\n}\n\n/* 按钮本体 */\n.segment-button {\n  position: relative;\n  flex: 1;\n  z-index: 1;\n  border: none;\n  outline: none;\n  background: transparent;\n  color: #333;\n  font-size: 14px;\n  font-weight: 500;\n  border-radius: 999px;\n  cursor: pointer;\n  transition: color 0.25s ease;\n}\n\n.segment-button.active {\n  color: #fff;\n}\n\n\n</style>","import { render } from \"./ChartPage.vue?vue&type=template&id=ce7a7c4e&scoped=true\"\nimport script from \"./ChartPage.vue?vue&type=script&lang=js\"\nexport * from \"./ChartPage.vue?vue&type=script&lang=js\"\n\nimport \"./ChartPage.vue?vue&type=style&index=0&id=ce7a7c4e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ce7a7c4e\"]])\n\nexport default __exports__","<template>\n  <div ref=\"chartContainer\" class=\"chart-view\"></div>\n</template>\n\n<script>\nimport { ref, onMounted, onBeforeUnmount, watch, nextTick } from 'vue';\nimport * as echarts from 'echarts';\n\nexport default {\n  name: 'ChartView',\n  props: {\n    option: {\n      type: Object,\n      required: true\n    },\n    debug: { // 可在父组件临时传 debug=true 打开更多日志\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(props) {\n    const chartContainer = ref(null);\n    let chartInstance = null;\n    let resizeObserver = null;\n    let initCount = 0;\n    let disposeCount = 0;\n    let setOptionCount = 0;\n\n    const log = (...args) => {\n      if (props.debug) {\n        console.log('[ChartView]', ...args);\n      }\n    };\n\n    const initChart = () => {\n      if (!chartContainer.value) return;\n\n      if (!chartInstance) {\n        initCount++;\n        console.time(`echarts-init-${initCount}`);\n        chartInstance = echarts.init(chartContainer.value);\n        console.timeEnd(`echarts-init-${initCount}`);\n        log(`init #${initCount} (container):`, chartContainer.value);\n\n        // resize 监听\n        window.addEventListener('resize', resizeChart);\n\n        resizeObserver = new ResizeObserver(() => {\n          if (chartInstance) {\n            chartInstance.resize();\n          }\n        });\n        resizeObserver.observe(chartContainer.value);\n      }\n\n      // 首次初始化后，如果已有 option 立即 setOption 一次\n      if (props.option && Object.keys(props.option).length > 0) {\n        applyOption(props.option);\n      }\n    };\n\n    const applyOption = (opt) => {\n      if (!chartInstance) return;\n      setOptionCount++;\n      const label = `echarts-setOption-${setOptionCount}`;\n      console.time(label);\n      // 第2个参数 notMerge = false 保留合并逻辑（你之前改成 false）\n      // 第3个参数 lazyUpdate = true 尽量降低同步更新开销（可观察效果）\n      try {\n        chartInstance.setOption(opt, false, true);\n      } catch (e) {\n        console.error('[ChartView] setOption error', e);\n      }\n      console.timeEnd(label);\n      log(`setOption count=${setOptionCount}`);\n    };\n\n    const resizeChart = () => {\n      if (chartInstance) {\n        chartInstance.resize();\n      }\n    };\n\n    onMounted(async () => {\n      await nextTick();\n      log('onMounted');\n      initChart();\n    });\n\n    watch(\n      () => props.option,\n      (newOption) => {\n        if (newOption && Object.keys(newOption).length > 0) {\n          // 给出更多日志：测量从 watch 到 setOption 的时间\n          const t0 = performance.now();\n          applyOption(newOption);\n          const t1 = performance.now();\n          log(`watch->applyOption elapsed ${(t1 - t0).toFixed(1)} ms`);\n        }\n      },\n      { deep: true }\n    );\n\n    onBeforeUnmount(() => {\n      disposeCount++;\n      console.time(`echarts-dispose-${disposeCount}`);\n      window.removeEventListener('resize', resizeChart);\n\n      if (resizeObserver && chartContainer.value) {\n        try {\n          resizeObserver.unobserve(chartContainer.value);\n          resizeObserver.disconnect();\n        } catch (e) { /* ignore */ }\n        resizeObserver = null;\n      }\n\n      if (chartInstance) {\n        try {\n          chartInstance.dispose();\n        } catch (e) { /* ignore */ }\n        chartInstance = null;\n      }\n      console.timeEnd(`echarts-dispose-${disposeCount}`);\n      log('onBeforeUnmount, disposeCount=', disposeCount);\n    });\n\n    return {\n      chartContainer\n    };\n  }\n};\n</script>\n\n<style scoped>\n.chart-view {\n  width: 100%;\n  height: 100%;\n}\n</style>","import { render } from \"./ChartView.vue?vue&type=template&id=4a7cde61&scoped=true\"\nimport script from \"./ChartView.vue?vue&type=script&lang=js\"\nexport * from \"./ChartView.vue?vue&type=script&lang=js\"\n\nimport \"./ChartView.vue?vue&type=style&index=0&id=4a7cde61&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4a7cde61\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_ChartView","option","$options","chartOption","components","ChartView","props","chart","Object","returnData","config","chartType","String","yearLimit","type","Number","default","isHorizontal","Boolean","computed","adjustedLegendTop","baseTop","this","legendTop","window","innerWidth","endsWith","num","parseFloat","params","data","cityCodeArr","title","subtitle","dbCode","zbcodeArr","unit","exceptName","gridTop","echrtId","id","getCommonChartOption","__exports__","render","key","_createElementVNode","_hoisted_2","_toDisplayString","$props","_hoisted_3","_createCommentVNode","_hoisted_4","_normalizeClass","$data","onClick","_cache","$event","_hoisted_5","_hoisted_6","_component_el_slider","modelValue","min","max","step","formatTooltip","_component_ChartCard","ChartCard","initialChartType","viewMode","val","internalShowToggles","active","_Fragment","_renderList","chartsToRender","_createBlock","_component_ChartContainer","ChartContainer","chartMetaList","Array","showToggles","dbCodes","Set","map","c","has","defaultViewMode","filteredCharts","filter","sj","dataList","isArray","length","created","ref","name","required","debug","setup","chartContainer","chartInstance","resizeObserver","initCount","disposeCount","setOptionCount","log","args","console","initChart","value","time","echarts","timeEnd","addEventListener","resizeChart","ResizeObserver","resize","observe","keys","applyOption","opt","label","setOption","e","error","onMounted","async","nextTick","watch","newOption","t0","performance","now","t1","toFixed","deep","onBeforeUnmount","removeEventListener","unobserve","disconnect","dispose"],"sourceRoot":""}