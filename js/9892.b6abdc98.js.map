{"version":3,"file":"js/9892.b6abdc98.js","mappings":"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","sources":["webpack://tangdata/./src/components/common/ChartCard.vue","webpack://tangdata/./src/components/common/ChartCard.vue?7a80","webpack://tangdata/./src/components/common/ChartContainer.vue","webpack://tangdata/./src/components/common/ChartContainer.vue?9df1","webpack://tangdata/./src/components/common/ChartPage.vue","webpack://tangdata/./src/components/common/ChartPage.vue?6ceb","webpack://tangdata/./src/components/common/ChartView.vue","webpack://tangdata/./src/components/common/ChartView.vue?7c38"],"sourcesContent":["<template>\n  <div class=\"chart-card\">\n    <ChartView :option=\"chartOption\" class=\"chart-wrapper\" />\n  </div>\n</template>\n\n<script>\nimport ChartView from './ChartView.vue';\nimport { getCommonChartOption } from '@/utils/CommonUtil.js';\n\nexport default {\n  components: { ChartView },\n  props: {\n    chart: Object,\n    returnData: Object,\n    config: Object,\n    chartType: String, // 'bar' 或 'line'\n    yearLimit: {\n      type: Number,\n      default: 10\n    },\n    isHorizontal: Boolean,\n    legendAllSelected: Boolean,\n  },\n  computed: {\n    adjustedLegendTop() {\n      const baseTop = this.chart.legendTop || '15%';\n\n      // 处理字符串百分比\n      if (window.innerWidth <= 768) { // 移动端\n        if (typeof baseTop === 'string' && baseTop.endsWith('%')) {\n          const num = parseFloat(baseTop);\n          return (num / 3) + '%'; // 缩小为原来的三分之一\n        }\n        if (typeof baseTop === 'number') {\n          return baseTop / 3; // 数值缩小\n        }\n        return '5%'; // 默认值\n      }\n      // PC端正常返回\n      return baseTop;\n    },\n\n    chartOption() {\n      const params = {\n        // 只取必要字段，避免污染\n        data: this.returnData,\n        cityCodeArr: this.config?.cityCodeArr || [],\n        // 图表相关\n        title: this.chart.title,\n        subtitle: this.chart.subtitle,\n        dbCode: this.chart.dbCode,\n        zbcodeArr: this.chart.zbcodeArr,\n        unit: this.chart.unit,\n        exceptName: this.chart.exceptName,\n        legendTop: this.adjustedLegendTop,\n        gridTop: this.chart.gridTop,\n        echrtId: this.chart.id,\n        chartType: this.chartType,\n        yearLimit: this.yearLimit,\n        isHorizontal: this.isHorizontal,\n        legendAllSelected: this.legendAllSelected,\n        \n      };\n      const option = getCommonChartOption(params);\n\n      if (option.title) delete option.title; // 防止重复标题显示\n\n      return option;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.chart-card {\n  width: 95%;\n  height: 600px;\n  margin: 0 auto;\n}\n\n.chart-wrapper {\n  width: 100%;\n  height: 100%;\n}\n</style>","import { render } from \"./ChartCard.vue?vue&type=template&id=16ae2ee1&scoped=true\"\nimport script from \"./ChartCard.vue?vue&type=script&lang=js\"\nexport * from \"./ChartCard.vue?vue&type=script&lang=js\"\n\nimport \"./ChartCard.vue?vue&type=style&index=0&id=16ae2ee1&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-16ae2ee1\"]])\n\nexport default __exports__","<template>\n    <div class=\"chart-container\">\n        <h3 class=\"chart-title\">{{ chart.title }}</h3>\n        <h4 v-if=\"chart.subtitle\" class=\"chart-subtitle\">{{ chart.subtitle }}</h4>\n\n        <!-- 父容器：包含第一行按钮和第二行控件 -->\n        <div class=\"controls-wrap\">\n            <!-- 第一行按钮 -->\n            <div class=\"chart-controls\">\n                <button :class=\"['chart-button', { 'is-active': chartType === 'bar' && !isHorizontal }]\"\n                    @click=\"chartType = 'bar'; isHorizontal = false\">柱状图</button>\n                <button :class=\"['chart-button', { 'is-active': chartType === 'bar' && isHorizontal }]\"\n                    @click=\"chartType = 'bar'; isHorizontal = true\">条形图</button>\n                <button :class=\"['chart-button', { 'is-active': chartType === 'line' && !isHorizontal }]\"\n                    @click=\"chartType = 'line'; isHorizontal = false\">折线图</button>\n            </div>\n\n            <!-- 第二行控件 -->\n            <div class=\"time-legend-row\">\n                <label class=\"year-label\">滑动时间</label>\n                <el-slider v-model=\"yearLimit\" :min=\"1\" :max=\"20\" :step=\"1\" show-tooltip :format-tooltip=\"formatTooltip\"\n                    class=\"year-slider\" />\n                <button class=\"toggle-legend-btn\" :style=\"{ backgroundColor: legendAllSelected ? '#0bc2d6' : '#ccc' }\"\n                    @click=\"toggleLegend\">\n                    {{ legendAllSelected ? '一键未选' : '一键全选' }}\n                </button>\n            </div>\n        </div>\n\n        <!-- 图表 -->\n        <ChartCard :chart=\"chart\" :chartType=\"chartType\" :returnData=\"returnData\" :config=\"config\"\n            :yearLimit=\"yearLimit\" :isHorizontal=\"isHorizontal\" :legendAllSelected=\"legendAllSelected\" />\n    </div>\n</template>\n\n<script>\nimport { ref } from 'vue';\nimport ChartCard from './ChartCard.vue';\n\nexport default {\n    components: { ChartCard },\n    props: {\n        chart: Object,\n        returnData: Object,\n        config: Object,\n        initialChartType: { type: String, default: 'bar' },\n        viewMode: String,\n    },\n    setup(props) {\n        const chartType = ref(props.initialChartType);\n        const isHorizontal = ref(false);\n        const yearLimit = ref(10);\n        const legendAllSelected = ref(true);\n\n        const toggleLegend = () => {\n            legendAllSelected.value = !legendAllSelected.value;\n        };\n\n        const formatTooltip = (val) => {\n            const unit = props.viewMode === 'monthly' ? '个月' : '年';\n            return `近 ${val} ${unit}`;\n        };\n\n        return { chartType, isHorizontal, yearLimit, legendAllSelected, toggleLegend, formatTooltip };\n    },\n};\n</script>\n\n<style scoped>\n.chart-container {\n    width: 100%;\n    max-width: 1500px;\n    margin: 50px auto 60px;\n    padding: 16px;\n    box-sizing: border-box;\n    background-color: #fff;\n    border-radius: 12px;\n    box-shadow: 0 0 8px rgba(0, 0, 0, 0.06);\n}\n\n.chart-title {\n    text-align: center;\n    font-size: 18px;\n    font-weight: 700;\n    color: #333;\n    margin: 24px 0 6px;\n}\n\n.chart-subtitle {\n    font-size: 13px;\n    font-weight: bold;\n    line-height: 20px;\n    color: #666;\n    text-align: center;\n    white-space: pre-line;\n    overflow-wrap: break-word;\n    margin: 0 auto 12px;\n    max-width: 80vw;\n}\n\n/* 父容器：包含第一行按钮和第二行控件 */\n.controls-wrap {\n    display: flex;\n    flex-direction: column;\n    width: fit-content;\n    /* 宽度自适应内容，即第一行按钮总宽度 */\n    margin: 0 auto;\n    /* 整体居中页面 */\n\n}\n\n/* 第一行按钮 */\n.chart-controls {\n    display: flex;\n    justify-content: center;\n    /* 整体居中 */\n    gap: 12px;\n    margin-top: 16px;\n    /* 调整与标题间距，原来可能太小 */\n}\n\n/* 第二行控件 */\n.time-legend-row {\n    display: flex;\n    justify-content: center;\n    /* 主轴居中，方便中间控件固定位置 */\n    margin-top: 16px;\n    gap: 16px;\n    /* 控件之间的间距 */\n    align-items: center;\n}\n\n.year-label {\n  flex-shrink: 0;\n  display: inline-block;\n  padding: 6px 12px;\n  font-size: 13px;\n  font-weight: 500;\n  border-radius: 10px;\n  color: #333;              /* 文本颜色改为深色 */\n  background-color: #f0f0f0; /* 浅灰背景区分按钮 */\n}\n\n.year-slider {\n    max-width: 200px;\n    min-width: 120px;\n}\n\n/* element-plus 滑块样式 */\n::v-deep(.year-slider .el-slider__bar) {\n    background-color: #0bc2d6 !important;\n}\n\n::v-deep(.year-slider .el-slider__button) {\n    background-color: #0bc2d6 !important;\n    border-color: #0bc2d6 !important;\n}\n\n.toggle-legend-btn {\n    flex-shrink: 0;\n    /* 不允许在 flex 行中被压缩 */\n    display: inline-flex;\n    padding: 6px 12px;\n    height: auto;\n    align-items: center;\n    color: #fff;\n    border: none;\n    border-radius: 10px;\n    cursor: pointer;\n    transition: background 0.3s;\n}\n\n/* 按钮样式 */\n.chart-button {\n    padding: 6px 12px;\n    margin: 10px;\n    font-size: 13px;\n    border-radius: 10px;\n    background-color: #ccc;\n    color: #fff;\n    border: none;\n    cursor: pointer;\n    transition: background 0.3s;\n}\n\n.chart-button.is-active {\n    background-color: #0bc2d6;\n}\n</style>","import { render } from \"./ChartContainer.vue?vue&type=template&id=5283f56c&scoped=true\"\nimport script from \"./ChartContainer.vue?vue&type=script&lang=js\"\nexport * from \"./ChartContainer.vue?vue&type=script&lang=js\"\n\nimport \"./ChartContainer.vue?vue&type=style&index=0&id=5283f56c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5283f56c\"]])\n\nexport default __exports__","<template>\n  <div class=\"echart-container\">\n    <div v-if=\"internalShowToggles\" class=\"segment-container\">\n      <div class=\"segment-wrapper\">\n        <div class=\"segment-bg\" :class=\"viewMode\"></div>\n        <button class=\"segment-button\" :class=\"{ active: viewMode === 'monthly' }\"\n          @click=\"viewMode = 'monthly'\">月度</button>\n        <button class=\"segment-button\" :class=\"{ active: viewMode === 'yearly' }\"\n          @click=\"viewMode = 'yearly'\">年度</button>\n      </div>\n    </div>\n\n    <ChartContainer v-for=\"chart in chartsToRender\" :key=\"chart.id\" :chart=\"chart\" :returnData=\"returnData\"\n      :config=\"config\" :viewMode=\"viewMode\" />\n  </div>\n</template>\n\n<script>\nimport ChartContainer from './ChartContainer.vue';\n\nexport default {\n  components: { ChartContainer },\n  props: {\n    chartMetaList: Array,\n    returnData: Object,\n    config: Object,\n    showToggles: { type: Boolean, default: true },\n  },\n  data() {\n    return {\n      viewMode: 'monthly',\n    };\n  },\n  computed: {\n    internalShowToggles() {\n      if (!this.showToggles) return false;\n      const dbCodes = new Set(this.chartMetaList.map((c) => c.dbCode));\n      return dbCodes.has('yd') && dbCodes.has('nd');\n    },\n    defaultViewMode() {\n      const dbCodes = new Set(this.chartMetaList.map((c) => c.dbCode));\n      if (dbCodes.has('yd')) return 'monthly';\n      if (dbCodes.has('nd')) return 'yearly';\n      return 'monthly';\n    },\n    filteredCharts() {\n      if (!this.internalShowToggles) return this.chartMetaList;\n      return this.chartMetaList.filter((c) =>\n        this.viewMode === 'monthly' ? c.dbCode === 'yd' : c.dbCode === 'nd'\n      );\n    },\n    chartsToRender() {\n      return this.filteredCharts.filter((chart) => {\n        const sj = this.returnData?.dataList?.sj?.[chart.dbCode];\n        return Array.isArray(sj) && sj.length > 0;\n      });\n    },\n  },\n  created() {\n    this.viewMode = this.defaultViewMode;\n  },\n};\n</script>\n\n<style scoped>\n.segment-container {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  margin-top: 10px;\n  margin-bottom: 30px;\n}\n\n.segment-wrapper {\n  position: relative;\n  display: flex;\n  width: 200px;\n  height: 45px;\n  background-color: #fff;\n  border-radius: 999px;\n  padding: 2px;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n  /* ✅ 外部阴影更明显 */\n}\n\n/* 背景高亮滑块 */\n.segment-bg {\n  position: absolute;\n  top: 2px;\n  bottom: 2px;\n  width: 50%;\n  border-radius: 999px;\n  background-color: #0bc2d6;\n  transition: left 0.25s ease;\n  z-index: 0;\n}\n\n.segment-bg.monthly {\n  left: 2px;\n}\n\n.segment-bg.yearly {\n  left: 50%;\n}\n\n/* 按钮本体 */\n.segment-button {\n  position: relative;\n  flex: 1;\n  z-index: 1;\n  border: none;\n  outline: none;\n  background: transparent;\n  color: #333;\n  font-size: 14px;\n  font-weight: 500;\n  border-radius: 999px;\n  cursor: pointer;\n  transition: color 0.25s ease;\n}\n\n.segment-button.active {\n  color: #fff;\n}\n\n\n</style>","import { render } from \"./ChartPage.vue?vue&type=template&id=ce7a7c4e&scoped=true\"\nimport script from \"./ChartPage.vue?vue&type=script&lang=js\"\nexport * from \"./ChartPage.vue?vue&type=script&lang=js\"\n\nimport \"./ChartPage.vue?vue&type=style&index=0&id=ce7a7c4e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ce7a7c4e\"]])\n\nexport default __exports__","<template>\n  <div ref=\"chartContainer\" class=\"chart-view\"></div>\n</template>\n\n<script>\nimport { ref, onMounted, onBeforeUnmount, watch, nextTick } from 'vue';\nimport * as echarts from 'echarts';\n\nexport default {\n  name: 'ChartView',\n  props: {\n    option: {\n      type: Object,\n      required: true\n    },\n    debug: { // 可在父组件临时传 debug=true 打开更多日志\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(props) {\n    const chartContainer = ref(null);\n    let chartInstance = null;\n    let resizeObserver = null;\n    let initCount = 0;\n    let disposeCount = 0;\n    let setOptionCount = 0;\n\n    const log = (...args) => {\n      if (props.debug) {\n        console.log('[ChartView]', ...args);\n      }\n    };\n\n    const initChart = () => {\n      if (!chartContainer.value) return;\n\n      if (!chartInstance) {\n        initCount++;\n        console.time(`echarts-init-${initCount}`);\n        chartInstance = echarts.init(chartContainer.value);\n        console.timeEnd(`echarts-init-${initCount}`);\n        log(`init #${initCount} (container):`, chartContainer.value);\n\n        // resize 监听\n        window.addEventListener('resize', resizeChart);\n\n        resizeObserver = new ResizeObserver(() => {\n          if (chartInstance) {\n            chartInstance.resize();\n          }\n        });\n        resizeObserver.observe(chartContainer.value);\n      }\n\n      // 首次初始化后，如果已有 option 立即 setOption 一次\n      if (props.option && Object.keys(props.option).length > 0) {\n        applyOption(props.option);\n      }\n    };\n\n    const applyOption = (opt) => {\n      if (!chartInstance) return;\n      setOptionCount++;\n      const label = `echarts-setOption-${setOptionCount}`;\n      console.time(label);\n      // 第2个参数 notMerge = false 保留合并逻辑（你之前改成 false）\n      // 第3个参数 lazyUpdate = true 尽量降低同步更新开销（可观察效果）\n      try {\n        chartInstance.setOption(opt, false, true);\n      } catch (e) {\n        console.error('[ChartView] setOption error', e);\n      }\n      console.timeEnd(label);\n      log(`setOption count=${setOptionCount}`);\n    };\n\n    const resizeChart = () => {\n      if (chartInstance) {\n        chartInstance.resize();\n      }\n    };\n\n    onMounted(async () => {\n      await nextTick();\n      log('onMounted');\n      initChart();\n    });\n\n    watch(\n      () => props.option,\n      (newOption) => {\n        if (newOption && Object.keys(newOption).length > 0) {\n          // 给出更多日志：测量从 watch 到 setOption 的时间\n          const t0 = performance.now();\n          applyOption(newOption);\n          const t1 = performance.now();\n          log(`watch->applyOption elapsed ${(t1 - t0).toFixed(1)} ms`);\n        }\n      },\n      { deep: true }\n    );\n\n    onBeforeUnmount(() => {\n      disposeCount++;\n      console.time(`echarts-dispose-${disposeCount}`);\n      window.removeEventListener('resize', resizeChart);\n\n      if (resizeObserver && chartContainer.value) {\n        try {\n          resizeObserver.unobserve(chartContainer.value);\n          resizeObserver.disconnect();\n        } catch (e) { /* ignore */ }\n        resizeObserver = null;\n      }\n\n      if (chartInstance) {\n        try {\n          chartInstance.dispose();\n        } catch (e) { /* ignore */ }\n        chartInstance = null;\n      }\n      console.timeEnd(`echarts-dispose-${disposeCount}`);\n      log('onBeforeUnmount, disposeCount=', disposeCount);\n    });\n\n    return {\n      chartContainer\n    };\n  }\n};\n</script>\n\n<style scoped>\n.chart-view {\n  width: 100%;\n  height: 100%;\n}\n</style>","import { render } from \"./ChartView.vue?vue&type=template&id=4a7cde61&scoped=true\"\nimport script from \"./ChartView.vue?vue&type=script&lang=js\"\nexport * from \"./ChartView.vue?vue&type=script&lang=js\"\n\nimport \"./ChartView.vue?vue&type=style&index=0&id=4a7cde61&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4a7cde61\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_ChartView","option","$options","chartOption","components","ChartView","props","chart","Object","returnData","config","chartType","String","yearLimit","type","Number","default","isHorizontal","Boolean","legendAllSelected","computed","adjustedLegendTop","baseTop","this","legendTop","window","innerWidth","endsWith","num","parseFloat","params","data","cityCodeArr","title","subtitle","dbCode","zbcodeArr","unit","exceptName","gridTop","echrtId","id","getCommonChartOption","__exports__","render","key","_createElementVNode","_hoisted_2","_toDisplayString","$props","_hoisted_3","_createCommentVNode","_hoisted_4","_hoisted_5","_normalizeClass","$setup","onClick","_cache","$event","_hoisted_6","_hoisted_7","_component_el_slider","modelValue","min","max","step","formatTooltip","style","_normalizeStyle","backgroundColor","args","toggleLegend","_component_ChartCard","ChartCard","initialChartType","viewMode","setup","ref","value","val","internalShowToggles","$data","active","_Fragment","_renderList","chartsToRender","_createBlock","_component_ChartContainer","ChartContainer","chartMetaList","Array","showToggles","dbCodes","Set","map","c","has","defaultViewMode","filteredCharts","filter","sj","dataList","isArray","length","created","name","required","debug","chartContainer","chartInstance","resizeObserver","initCount","disposeCount","setOptionCount","log","console","initChart","time","echarts","timeEnd","addEventListener","resizeChart","ResizeObserver","resize","observe","keys","applyOption","opt","label","setOption","e","error","onMounted","async","nextTick","watch","newOption","t0","performance","now","t1","toFixed","deep","onBeforeUnmount","removeEventListener","unobserve","disconnect","dispose"],"sourceRoot":""}