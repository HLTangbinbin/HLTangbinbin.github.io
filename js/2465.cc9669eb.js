"use strict";(self["webpackChunktangdata"]=self["webpackChunktangdata"]||[]).push([[2465],{2465:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var r=a(6768);function n(t,e,a,n,o,s){const l=(0,r.g2)("ChartPage");return o.returnData?((0,r.uX)(),(0,r.Wv)(l,{key:0,chartMetaList:o.charts,returnData:o.returnData,config:o.config,showToggles:!1},null,8,["chartMetaList","returnData","config"])):(0,r.Q3)("",!0)}var o=a(933),s=a(6280),l=a(6311),c=a(373),i={name:"GrossDomesticProduct",components:{ChartPage:o.A},data(){return{charts:s.d$.charts,returnData:null,config:s.d$.source}},async mounted(){try{this.returnData=await(0,l.hv)(this.config)}catch(t){c.v.error("加载数据失败",t)}}},d=a(1241);const u=(0,d.A)(i,[["render",n]]);var h=u},933:function(t,e,a){a.d(e,{A:function(){return z}});var r=a(6768),n=a(4232);const o={class:"echart-container"},s={key:0,class:"segment-container"},l={class:"segment-wrapper"};function c(t,e,a,c,i,d){const u=(0,r.g2)("ChartContainer");return(0,r.uX)(),(0,r.CE)("div",o,[d.internalShowToggles?((0,r.uX)(),(0,r.CE)("div",s,[(0,r.Lk)("div",l,[(0,r.Lk)("div",{class:(0,n.C4)(["segment-bg",i.viewMode])},null,2),(0,r.Lk)("button",{class:(0,n.C4)(["segment-button",{active:"monthly"===i.viewMode}]),onClick:e[0]||(e[0]=t=>i.viewMode="monthly")},"月度",2),(0,r.Lk)("button",{class:(0,n.C4)(["segment-button",{active:"yearly"===i.viewMode}]),onClick:e[1]||(e[1]=t=>i.viewMode="yearly")},"年度",2)])])):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(d.chartsToRender,(t=>((0,r.uX)(),(0,r.Wv)(u,{key:t.id,chart:t,returnData:a.returnData,config:a.config,viewMode:i.viewMode},null,8,["chart","returnData","config","viewMode"])))),128))])}const i=t=>((0,r.Qi)("data-v-4e2d40b0"),t=t(),(0,r.jt)(),t),d={class:"chart-container"},u={class:"chart-title"},h={key:0,class:"chart-subtitle"},p={class:"controls-wrap"},v={class:"chart-controls"},g={class:"time-legend-row"},y=i((()=>(0,r.Lk)("label",{class:"year-label"},"滑动时间",-1))),b={class:"chart-card"};function C(t,e,a,o,s,l){const c=(0,r.g2)("el-slider"),i=(0,r.g2)("ChartView");return(0,r.uX)(),(0,r.CE)("div",d,[(0,r.Lk)("h3",u,(0,n.v_)(a.chart.title),1),a.chart.subtitle?((0,r.uX)(),(0,r.CE)("h4",h,(0,n.v_)(a.chart.subtitle),1)):(0,r.Q3)("",!0),(0,r.Lk)("div",p,[(0,r.Lk)("div",v,[(0,r.Lk)("button",{class:(0,n.C4)(["chart-button",{"is-active":"bar"===o.chartType&&!o.isHorizontal}]),onClick:e[0]||(e[0]=t=>o.setChartType("bar",!1))},"柱状图",2),(0,r.Lk)("button",{class:(0,n.C4)(["chart-button",{"is-active":"bar"===o.chartType&&o.isHorizontal}]),onClick:e[1]||(e[1]=t=>o.setChartType("bar",!0))},"条形图",2),(0,r.Lk)("button",{class:(0,n.C4)(["chart-button",{"is-active":"line"===o.chartType&&!o.isHorizontal}]),onClick:e[2]||(e[2]=t=>o.setChartType("line",!1))},"折线图",2)]),(0,r.Lk)("div",g,[y,(0,r.bF)(c,{modelValue:o.yearLimit,"onUpdate:modelValue":e[3]||(e[3]=t=>o.yearLimit=t),min:1,max:20,step:1,"show-tooltip":"","format-tooltip":o.formatTooltip,class:"year-slider"},null,8,["modelValue","format-tooltip"]),(0,r.Lk)("button",{class:"toggle-legend-btn",style:(0,n.Tr)({backgroundColor:o.legendAllSelected?"#0bc2d6":"#ccc"}),onClick:e[4]||(e[4]=(...t)=>o.toggleAllLegends&&o.toggleAllLegends(...t))},(0,n.v_)(o.legendAllSelected?"一键未选":"一键全选"),5)])]),(0,r.Lk)("div",b,[(0,r.bF)(i,{option:o.chartOption,class:"chart-wrapper",onLegendselectchanged:o.handleLegendSelect},null,8,["option","onLegendselectchanged"])])])}var f=a(144);const m={ref:"chartContainer",class:"chart-view"};function w(t,e,a,n,o,s){return(0,r.uX)(),(0,r.CE)("div",m,null,512)}var L=a(1557),k={props:["option"],setup(t){const e=(0,f.KR)(null);let a=null;const n=()=>{if(e.value){a&&a.dispose();try{a=L.Ts(e.value);const r={xAxis:{type:"category",data:["A","B","C"]},yAxis:{type:"value"},series:[{data:[1,2,3],type:"line"}]};a.setOption(r),t.option&&a.setOption(t.option),a.resize(),setTimeout((()=>{}),100)}catch(r){}}};return(0,r.sV)((()=>{n()})),(0,r.wB)((()=>t.option),(t=>{a&&t&&a.setOption(t)}),{deep:!0}),(0,r.xo)((()=>{a?.dispose()})),{chartContainer:e}}},T=a(1241);const A=(0,T.A)(k,[["render",w],["__scopeId","data-v-4f5c540a"]]);var M=A,D=a(5e3),O={name:"ChartContainer",components:{ChartView:M},props:{chart:{type:Object,required:!0},returnData:{type:Object,required:!0},config:{type:Object,default:()=>({})},viewMode:{type:String,default:"monthly"}},setup(t){const e=(0,f.KR)("bar"),a=(0,f.KR)(!1),n=(0,f.KR)(10),o=(0,f.KR)({}),s=(0,f.KR)(!0),l=(0,r.EW)((()=>{const r={data:t.returnData,cityCodeArr:t.config?.cityCodeArr||[],title:t.chart.title,subtitle:t.chart.subtitle,dbCode:t.chart.dbCode,zbcodeArr:t.chart.zbcodeArr,unit:t.chart.unit,exceptName:t.chart.exceptName,legendTop:c(),gridTop:t.chart.gridTop,echrtId:t.chart.id,chartType:e.value,yearLimit:n.value,isHorizontal:a.value,legendStates:o.value,legendAllSelected:s.value},l=(0,D.HM)(r);return l.title&&delete l.title,l})),c=()=>{const e=t.chart.legendTop||"15%";if(window.innerWidth<=768){if("string"===typeof e&&e.endsWith("%")){const t=parseFloat(e);return t/3+"%"}return"number"===typeof e?e/3:"5%"}return e},i=(t,r)=>{e.value=t,a.value=r},d=t=>{t?.name&&(o.value={...o.value,[t.name]:t.selected[t.name]},u())},u=()=>{const t=Object.values(o.value);s.value=t.length>0&&t.every((t=>t))},h=()=>{const t=!s.value,e={};Object.keys(o.value).forEach((a=>{e[a]=t})),o.value=e,s.value=t};(0,r.wB)(n,(()=>{const t={};Object.keys(o.value).forEach((e=>{t[e]=!0})),o.value=t,s.value=!0}));const p=e=>{const a="monthly"===t.viewMode?"个月":"年";return`近 ${e} ${a}`};return{chartType:e,isHorizontal:a,yearLimit:n,legendAllSelected:s,chartOption:l,setChartType:i,handleLegendSelect:d,toggleAllLegends:h,formatTooltip:p}}};const S=(0,T.A)(O,[["render",C],["__scopeId","data-v-4e2d40b0"]]);var j=S,E={components:{ChartContainer:j},props:{chartMetaList:Array,returnData:Object,config:Object,showToggles:{type:Boolean,default:!0}},data(){return{viewMode:"monthly"}},computed:{internalShowToggles(){if(!this.showToggles)return!1;const t=new Set(this.chartMetaList.map((t=>t.dbCode)));return t.has("yd")&&t.has("nd")},defaultViewMode(){const t=new Set(this.chartMetaList.map((t=>t.dbCode)));return t.has("yd")?"monthly":t.has("nd")?"yearly":"monthly"},filteredCharts(){return this.internalShowToggles?this.chartMetaList.filter((t=>"monthly"===this.viewMode?"yd"===t.dbCode:"nd"===t.dbCode)):this.chartMetaList},chartsToRender(){return this.filteredCharts.filter((t=>{const e=this.returnData?.dataList?.sj?.[t.dbCode];return Array.isArray(e)&&e.length>0}))}},created(){this.viewMode=this.defaultViewMode}};const _=(0,T.A)(E,[["render",c],["__scopeId","data-v-ce7a7c4e"]]);var z=_}}]);
//# sourceMappingURL=2465.cc9669eb.js.map