"use strict";(self["webpackChunktangdata"]=self["webpackChunktangdata"]||[]).push([[8264,5631,88],{5631:function(t,e,r){r.r(e),r.d(e,{default:function(){return d}});var a=r(6768);const i={class:"chart-card"};function o(t,e,r,o,n,c){const s=(0,a.g2)("ChartView");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(s,{option:c.chartOption,class:"chart-wrapper"},null,8,["option"])])}var n=r(88),c=r(5e3),s={components:{ChartView:n["default"]},props:{chart:Object,returnData:Object,config:Object,chartType:String,yearLimit:{type:Number,default:10},isHorizontal:Boolean},computed:{adjustedLegendTop(){const t=this.chart.legendTop||"15%";if(window.innerWidth<=768){if("string"===typeof t&&t.endsWith("%")){const e=parseFloat(t);return e/3+"%"}return"number"===typeof t?t/3:"5%"}return t},chartOption(){const t={data:this.returnData,cityCodeArr:this.config?.cityCodeArr||[],title:this.chart.title,subtitle:this.chart.subtitle,dbCode:this.chart.dbCode,zbcodeArr:this.chart.zbcodeArr,unit:this.chart.unit,exceptName:this.chart.exceptName,legendTop:this.adjustedLegendTop,gridTop:this.chart.gridTop,echrtId:this.chart.id,chartType:this.chartType,yearLimit:this.yearLimit,isHorizontal:this.isHorizontal},e=(0,c.HM)(t);return e.title&&delete e.title,e}}},l=r(1241);const u=(0,l.A)(s,[["render",o],["__scopeId","data-v-634bd65e"]]);var d=u},8264:function(t,e,r){r.r(e),r.d(e,{default:function(){return m}});var a=r(6768),i=r(4232);const o=t=>((0,a.Qi)("data-v-10d8bf4a"),t=t(),(0,a.jt)(),t),n={class:"chart-container"},c={class:"chart-title"},s={key:0,class:"chart-subtitle"},l={class:"chart-controls"},u={class:"year-selector"},d=o((()=>(0,a.Lk)("label",{class:"year-label"},"选择时间范围",-1)));function h(t,e,r,o,h,p){const b=(0,a.g2)("el-slider"),y=(0,a.g2)("ChartCard");return(0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("h3",c,(0,i.v_)(r.chart.title),1),r.chart.subtitle?((0,a.uX)(),(0,a.CE)("h4",s,(0,i.v_)(r.chart.subtitle),1)):(0,a.Q3)("",!0),(0,a.Lk)("div",l,[(0,a.Lk)("button",{class:(0,i.C4)(["chart-button",{"is-active":"bar"===h.chartType&&!1===h.isHorizontal}]),onClick:e[0]||(e[0]=t=>{h.chartType="bar",h.isHorizontal=!1}),type:"button"}," 柱状图 ",2),(0,a.Lk)("button",{class:(0,i.C4)(["chart-button",{"is-active":"bar"===h.chartType&&!0===h.isHorizontal}]),onClick:e[1]||(e[1]=t=>{h.chartType="bar",h.isHorizontal=!0}),type:"button"}," 条形图 ",2),(0,a.Lk)("button",{class:(0,i.C4)(["chart-button",{"is-active":"line"===h.chartType&&!1===h.isHorizontal}]),onClick:e[2]||(e[2]=t=>{h.chartType="line",h.isHorizontal=!1}),type:"button"}," 折线图 ",2)]),(0,a.Lk)("div",u,[d,(0,a.bF)(b,{modelValue:h.yearLimit,"onUpdate:modelValue":e[3]||(e[3]=t=>h.yearLimit=t),min:1,max:20,step:1,"show-tooltip":"","format-tooltip":p.formatTooltip,class:"year-slider"},null,8,["modelValue","format-tooltip"])]),(0,a.bF)(y,{chart:r.chart,chartType:h.chartType,returnData:r.returnData,config:r.config,yearLimit:h.yearLimit,isHorizontal:h.isHorizontal},null,8,["chart","chartType","returnData","config","yearLimit","isHorizontal"])])}var p=r(5631),b={components:{ChartCard:p["default"]},props:{chart:Object,returnData:Object,config:Object,initialChartType:{type:String,default:"bar"},viewMode:String},data(){return{chartType:this.initialChartType,yearLimit:10,isHorizontal:!1}},computed:{formatTooltip(){return t=>{const e="monthly"===this.viewMode?"个月":"年";return`近 ${t} ${e}`}}}},y=r(1241);const f=(0,y.A)(b,[["render",h],["__scopeId","data-v-10d8bf4a"]]);var m=f},88:function(t,e,r){r.r(e),r.d(e,{default:function(){return d}});var a=r(6768);const i={ref:"chartContainer",class:"chart-view"};function o(t,e,r,o,n,c){return(0,a.uX)(),(0,a.CE)("div",i,null,512)}var n=r(144),c=r(9671),s={name:"ChartView",props:{option:{type:Object,required:!0},debug:{type:Boolean,default:!1}},setup(t){const e=(0,n.KR)(null);let r=null,i=null,o=0,s=0,l=0;const u=(...e)=>{t.debug&&console.log("[ChartView]",...e)},d=()=>{e.value&&(r||(o++,console.time(`echarts-init-${o}`),r=c.Ts(e.value),console.timeEnd(`echarts-init-${o}`),u(`init #${o} (container):`,e.value),window.addEventListener("resize",p),i=new ResizeObserver((()=>{r&&r.resize()})),i.observe(e.value)),t.option&&Object.keys(t.option).length>0&&h(t.option))},h=t=>{if(!r)return;l++;const e=`echarts-setOption-${l}`;console.time(e);try{r.setOption(t,!1,!0)}catch(a){console.error("[ChartView] setOption error",a)}console.timeEnd(e),u(`setOption count=${l}`)},p=()=>{r&&r.resize()};return(0,a.sV)((async()=>{await(0,a.dY)(),u("onMounted"),d()})),(0,a.wB)((()=>t.option),(t=>{if(t&&Object.keys(t).length>0){const e=performance.now();h(t);const r=performance.now();u(`watch->applyOption elapsed ${(r-e).toFixed(1)} ms`)}}),{deep:!0}),(0,a.xo)((()=>{if(s++,console.time(`echarts-dispose-${s}`),window.removeEventListener("resize",p),i&&e.value){try{i.unobserve(e.value),i.disconnect()}catch(t){}i=null}if(r){try{r.dispose()}catch(t){}r=null}console.timeEnd(`echarts-dispose-${s}`),u("onBeforeUnmount, disposeCount=",s)})),{chartContainer:e}}},l=r(1241);const u=(0,l.A)(s,[["render",o],["__scopeId","data-v-4a7cde61"]]);var d=u}}]);
//# sourceMappingURL=8264.160b932e.js.map